<script>
  const API_URL = "https://script.google.com/macros/s/PASTE_EXEC_URL/exec"; // URL-ul Web App (…/exec)

  const SECRET = "SUPER_SECRETA_TA_LUNGA"; // aceeași și în Replit

  document.getElementById("send").addEventListener("click", async () => {
    const data = {
      id: document.getElementById("id").value.trim(),
      nume: document.getElementById("nume").value.trim(),
      discord: document.getElementById("discord").value.trim(),
      telefon: document.getElementById("telefon").value.trim(),
      mentiuni: document.getElementById("mentiuni").value.trim(),
      hp_field: document.getElementById("hp_field")?.value || "",
      secret: SECRET
    };

    // validări minime
    if (!/^\d{3,10}$/.test(data.id)) return show("⚠️ ID invalid");
    if (!(data.nume.length >= 2 && data.nume.length <= 50)) return show("⚠️ Nume invalid");

    try {
      await fetch(API_URL, {
        method: "POST",
        // evităm preflight-ul CORS
        headers: { "Content-Type": "text/plain" },
        body: JSON.stringify(data),
        // opțional (și mai safe față de CORS):
        // mode: "no-cors"
      });
      show("✔ Felicitări, ai fost programat! Așteaptă să fii contactat.", true);
    } catch (e) {
      show("❌ Nu s-a putut trimite. Încearcă mai târziu.");
    }

    function show(t, ok=false){
      document.getElementById("msg").innerHTML =
        `<span style="color:${ok?'lime':'#ff6b6b'}">${t}</span>`;
    }
  });
</script>
